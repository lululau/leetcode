* [[https://leetcode.com/problems/total-sales-amount-by-year][1384.
Total Sales Amount by Year]]
  :PROPERTIES:
  :CUSTOM_ID: total-sales-amount-by-year
  :END:
[[./solution/1300-1399/1384.Total Sales Amount by Year/README.org][中文文档]]

** Description
   :PROPERTIES:
   :CUSTOM_ID: description
   :END:

#+begin_html
  <p>
#+end_html

Table: Product

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +---------------+---------+
  | Column Name   | Type    |
  +---------------+---------+
  | product_id    | int     |
  | product_name  | varchar |
  +---------------+---------+
  product_id is the primary key for this table.
  product_name is the name of the product.
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Table: Sales

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +---------------------+---------+
  | Column Name         | Type    |
  +---------------------+---------+
  | product_id          | int     |
  | period_start        | date    |
  | period_end          | date    |
  | average_daily_sales | int     |
  +---------------------+---------+
  product_id is the primary key for this table. 
  period_start&nbsp;and period_end&nbsp;indicates the start and end date for sales period, both dates are inclusive.
  The average_daily_sales column holds the average daily&nbsp;sales amount of the items for the&nbsp;period.

  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

Write an SQL query to report the Total sales amount of each item for
each year, with corresponding product name, product_id, product_name and
report_year.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Dates of the sales years are between 2018 to 2020. Return the result
table ordered by product_id and report_year.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

The query result format is in the following example:

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  <code>Product</code> table:
  +------------+--------------+
  | product_id | product_name |
  +------------+--------------+
  | 1          | LC Phone     |
  | 2          | LC T-Shirt   |
  | 3          | LC Keychain  |
  +------------+--------------+

  <code>Sales</code> table:
  +------------+--------------+-------------+---------------------+
  | product_id | period_start | period_end  | average_daily_sales |
  +------------+--------------+-------------+---------------------+
  | 1          | 2019-01-25   | 2019-02-28  | 100                 |
  | 2          | 2018-12-01   | 2020-01-01  | 10                  |
  | 3          | 2019-12-01   | 2020-01-31  | 1                   |
  +------------+--------------+-------------+---------------------+

  Result table:
  +------------+--------------+-------------+--------------+
  | product_id | product_name | report_year | total_amount |
  +------------+--------------+-------------+--------------+
  | 1          | LC Phone     |    2019     | 3500         |
  | 2          | LC T-Shirt   |    2018     | 310          |
  | 2          | LC T-Shirt   |    2019     | 3650         |
  | 2          | LC T-Shirt   |    2020     | 10           |
  | 3          | LC Keychain  |    2019     | 31           |
  | 3          | LC Keychain  |    2020     | 31           |
  +------------+--------------+-------------+--------------+
  LC Phone was sold for the period of 2019-01-25 to 2019-02-28, and there are 35 days for this period. Total amount 35*100 = 3500.&nbsp;
  LC T-shirt was sold for the period of 2018-12-01&nbsp;to 2020-01-01, and there are 31, 365, 1 days for years 2018, 2019 and 2020 respectively.
  LC Keychain was sold for the period of 2019-12-01&nbsp;to 2020-01-31, and there are 31, 31 days for years 2019 and 2020 respectively.
  </pre>
#+end_html

** Solutions
   :PROPERTIES:
   :CUSTOM_ID: solutions
   :END:

#+begin_html
  <!-- tabs:start -->
#+end_html

*** *SQL*
    :PROPERTIES:
    :CUSTOM_ID: sql
    :END:
#+begin_src sql
#+end_src

#+begin_html
  <!-- tabs:end -->
#+end_html

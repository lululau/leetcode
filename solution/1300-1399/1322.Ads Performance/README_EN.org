* [[https://leetcode.com/problems/ads-performance][1322. Ads
Performance]]
  :PROPERTIES:
  :CUSTOM_ID: ads-performance
  :END:
[[./solution/1300-1399/1322.Ads Performance/README.org][中文文档]]

** Description
   :PROPERTIES:
   :CUSTOM_ID: description
   :END:

#+begin_html
  <p>
#+end_html

Table: Ads

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +---------------+---------+
  | Column Name   | Type    |
  +---------------+---------+
  | ad_id         | int     |
  | user_id       | int     |
  | action        | enum    |
  +---------------+---------+
  (ad_id, user_id) is the primary key for this table.
  Each row of this table contains the ID of an Ad, the ID of a user and the action taken by this user regarding this Ad.
  The action column is an ENUM type of (&#39;Clicked&#39;, &#39;Viewed&#39;, &#39;Ignored&#39;).
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

A company is running Ads and wants to calculate the performance of each
Ad.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Performance of the Ad is measured using Click-Through Rate (CTR) where:

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Write an SQL query to find the ctr of each Ad.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Round ctr to 2 decimal points. Order the result table by ctr in
descending order and by ad_id in ascending order in case of a tie.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

The query result format is in the following example:

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  Ads table:
  +-------+---------+---------+
  | ad_id | user_id | action  |
  +-------+---------+---------+
  | 1     | 1       | Clicked |
  | 2     | 2       | Clicked |
  | 3     | 3       | Viewed  |
  | 5     | 5       | Ignored |
  | 1     | 7       | Ignored |
  | 2     | 7       | Viewed  |
  | 3     | 5       | Clicked |
  | 1     | 4       | Viewed  |
  | 2     | 11      | Viewed  |
  | 1     | 2       | Clicked |
  +-------+---------+---------+
  Result table:
  +-------+-------+
  | ad_id | ctr   |
  +-------+-------+
  | 1     | 66.67 |
  | 3     | 50.00 |
  | 2     | 33.33 |
  | 5     | 0.00  |
  +-------+-------+
  for ad_id = 1, ctr = (2/(2+1)) * 100 = 66.67
  for ad_id = 2, ctr = (1/(1+2)) * 100 = 33.33
  for ad_id = 3, ctr = (1/(1+1)) * 100 = 50.00
  for ad_id = 5, ctr = 0.00, Note that ad_id = 5 has no clicks or views.
  Note that we don&#39;t care about Ignored Ads.
  Result table is ordered by the ctr. in case of a tie we order them by ad_id
  </pre>
#+end_html

** Solutions
   :PROPERTIES:
   :CUSTOM_ID: solutions
   :END:

#+begin_html
  <!-- tabs:start -->
#+end_html

*** *SQL*
    :PROPERTIES:
    :CUSTOM_ID: sql
    :END:
#+begin_src sql
#+end_src

#+begin_html
  <!-- tabs:end -->
#+end_html

* [[https://leetcode.com/problems/find-the-team-size][1303. Find the
Team Size]]
  :PROPERTIES:
  :CUSTOM_ID: find-the-team-size
  :END:
[[./solution/1300-1399/1303.Find the Team Size/README.org][中文文档]]

** Description
   :PROPERTIES:
   :CUSTOM_ID: description
   :END:

#+begin_html
  <p>
#+end_html

Table: Employee

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +---------------+---------+
  | Column Name   | Type    |
  +---------------+---------+
  | employee_id   | int     |
  | team_id       | int     |
  +---------------+---------+
  employee_id is the primary key for this table.
  Each row of this table contains the ID of each employee and their respective team.
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

Write an SQL query to find the team size of each of the employees.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Return result table in any order.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

The query result format is in the following example:

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  Employee Table:
  +-------------+------------+
  | employee_id | team_id    |
  +-------------+------------+
  |     1       |     8      |
  |     2       |     8      |
  |     3       |     8      |
  |     4       |     7      |
  |     5       |     9      |
  |     6       |     9      |
  +-------------+------------+
  Result table:
  +-------------+------------+
  | employee_id | team_size  |
  +-------------+------------+
  |     1       |     3      |
  |     2       |     3      |
  |     3       |     3      |
  |     4       |     1      |
  |     5       |     2      |
  |     6       |     2      |
  +-------------+------------+
  Employees with Id 1,2,3 are part of a team with team_id = 8.
  Employees with Id 4 is part of a team with team_id = 7.
  Employees with Id 5,6 are part of a team with team_id = 9.

  </pre>
#+end_html

** Solutions
   :PROPERTIES:
   :CUSTOM_ID: solutions
   :END:

#+begin_html
  <!-- tabs:start -->
#+end_html

*** *SQL*
    :PROPERTIES:
    :CUSTOM_ID: sql
    :END:
Solution 1:

#+begin_src sql
  # Write your MySQL query statement below
  SELECT
      e.employee_id, t.team_size
  FROM
      Employee e
  LEFT JOIN
      (SELECT
          team_id, count(1) as team_size
      FROM
          Employee
      GROUP BY
          team_id
      ) t
  ON
      e.team_id = t.team_id;
#+end_src

Solution 2:

#+begin_src sql
  # Write your MySQL query statement below
  SELECT
      e1.employee_id, count(*) as team_size
  FROM
      Employee e1
  LEFT JOIN
      Employee e2
  ON
      e1.team_id = e2.team_id
  GROUP BY
      e1.employee_id;
#+end_src

#+begin_html
  <!-- tabs:end -->
#+end_html

* [[https://leetcode-cn.com/problems/find-the-team-size][1303.
求团队人数]]
  :PROPERTIES:
  :CUSTOM_ID: 求团队人数
  :END:
[[./solution/1300-1399/1303.Find the Team Size/README_EN.org][English
Version]]

** 题目描述
   :PROPERTIES:
   :CUSTOM_ID: 题目描述
   :END:

#+begin_html
  <!-- 这里写题目描述 -->
#+end_html

#+begin_html
  <p>
#+end_html

员工表：Employee

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +---------------+---------+
  | Column Name   | Type    |
  +---------------+---------+
  | employee_id   | int     |
  | team_id       | int     |
  +---------------+---------+
  employee_id 字段是这张表的主键，表中的每一行都包含每个员工的 ID 和他们所属的团队。
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

编写一个 SQL 查询，以求得每个员工所在团队的总人数。

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

查询结果中的顺序无特定要求。

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

查询结果格式示例如下：

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  Employee Table:
  +-------------+------------+
  | employee_id | team_id    |
  +-------------+------------+
  |     1       |     8      |
  |     2       |     8      |
  |     3       |     8      |
  |     4       |     7      |
  |     5       |     9      |
  |     6       |     9      |
  +-------------+------------+
  Result table:
  +-------------+------------+
  | employee_id | team_size  |
  +-------------+------------+
  |     1       |     3      |
  |     2       |     3      |
  |     3       |     3      |
  |     4       |     1      |
  |     5       |     2      |
  |     6       |     2      |
  +-------------+------------+
  ID 为 1、2、3 的员工是 team_id 为 8 的团队的成员，
  ID 为 4 的员工是 team_id 为 7 的团队的成员，
  ID 为 5、6 的员工是 team_id 为 9 的团队的成员。
  </pre>
#+end_html

** 解法
   :PROPERTIES:
   :CUSTOM_ID: 解法
   :END:

#+begin_html
  <!-- 这里可写通用的实现逻辑 -->
#+end_html

#+begin_html
  <!-- tabs:start -->
#+end_html

*** *SQL*
    :PROPERTIES:
    :CUSTOM_ID: sql
    :END:
解法 1：

#+begin_src sql
  # Write your MySQL query statement below
  SELECT
      e.employee_id, t.team_size
  FROM
      Employee e
  LEFT JOIN
      (SELECT
          team_id, count(1) as team_size
      FROM
          Employee
      GROUP BY
          team_id
      ) t
  ON
      e.team_id = t.team_id;
#+end_src

解法 2：

#+begin_src sql
  # Write your MySQL query statement below
  SELECT
      e1.employee_id, count(*) as team_size
  FROM
      Employee e1
  LEFT JOIN
      Employee e2
  ON
      e1.team_id = e2.team_id
  GROUP BY
      e1.employee_id;
#+end_src

#+begin_html
  <!-- tabs:end -->
#+end_html

* [[https://leetcode.com/problems/get-the-second-most-recent-activity][1369.
Get the Second Most Recent Activity]]
  :PROPERTIES:
  :CUSTOM_ID: get-the-second-most-recent-activity
  :END:
[[./solution/1300-1399/1369.Get the Second Most Recent Activity/README.org][中文文档]]

** Description
   :PROPERTIES:
   :CUSTOM_ID: description
   :END:

#+begin_html
  <p>
#+end_html

Table: UserActivity

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>

  +---------------+---------+

  | Column Name   | Type    |

  +---------------+---------+

  | username      | varchar |

  | activity      | varchar |

  | startDate     | Date    |

  | endDate       | Date    |

  +---------------+---------+

  This table does not contain primary key.

  This table contain information about the activity performed of each user in a period of time.

  A person with username performed a activity from startDate to endDate.



  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

Write an SQL query to show the second most recent activity of each user.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

If the user only has one activity, return that one. 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

A user can't perform more than one activity at the same time. Return the
result table in any order.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

The query result format is in the following example:

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>

  <code>UserActivity</code> table:

  +------------+--------------+-------------+-------------+

  | username   | activity     | startDate   | endDate     |

  +------------+--------------+-------------+-------------+

  | Alice      | Travel       | 2020-02-12  | 2020-02-20  |

  | Alice      | Dancing      | 2020-02-21  | 2020-02-23  |

  | Alice      | Travel       | 2020-02-24  | 2020-02-28  |

  | Bob        | Travel       | 2020-02-11  | 2020-02-18  |

  +------------+--------------+-------------+-------------+



  Result table:

  +------------+--------------+-------------+-------------+

  | username   | activity     | startDate   | endDate     |

  +------------+--------------+-------------+-------------+

  | Alice      | Dancing      | 2020-02-21  | 2020-02-23  |

  | Bob        | Travel       | 2020-02-11  | 2020-02-18  |

  +------------+--------------+-------------+-------------+



  The most recent activity of Alice is Travel from 2020-02-24 to 2020-02-28, before that she was dancing from 2020-02-21 to 2020-02-23.

  Bob only has one record, we just take that one.

  </pre>
#+end_html

** Solutions
   :PROPERTIES:
   :CUSTOM_ID: solutions
   :END:

#+begin_html
  <!-- tabs:start -->
#+end_html

*** *SQL*
    :PROPERTIES:
    :CUSTOM_ID: sql
    :END:
#+begin_src sql
#+end_src

#+begin_html
  <!-- tabs:end -->
#+end_html

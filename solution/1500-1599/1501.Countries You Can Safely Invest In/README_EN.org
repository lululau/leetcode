* [[https://leetcode.com/problems/countries-you-can-safely-invest-in][1501.
Countries You Can Safely Invest In]]
  :PROPERTIES:
  :CUSTOM_ID: countries-you-can-safely-invest-in
  :END:
[[./solution/1500-1599/1501.Countries You Can Safely Invest In/README.org][中文文档]]

** Description
   :PROPERTIES:
   :CUSTOM_ID: description
   :END:

#+begin_html
  <p>
#+end_html

Table Person:

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +----------------+---------+
  | Column Name    | Type    |
  +----------------+---------+
  | id             | int     |
  | name           | varchar |
  | phone_number   | varchar |
  +----------------+---------+
  id is the primary key for this table.
  Each row of this table contains the name of a person and their phone number.
  Phone number will be in the form &#39;xxx-yyyyyyy&#39; where xxx is the country code (3 characters) and yyyyyyy is the phone number (7 characters) where x and y are digits. Both can contain leading zeros.
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Table Country:

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +----------------+---------+
  | Column Name    | Type    |
  +----------------+---------+
  | name           | varchar |
  | country_code   | varchar |
  +----------------+---------+
  country_code is the primary key for this table.
  Each row of this table contains the country name and its code. country_code will be in the form &#39;xxx&#39; where x is digits.
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Table Calls:

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +-------------+------+
  | Column Name | Type |
  +-------------+------+
  | caller_id   | int  |
  | callee_id   | int  |
  | duration    | int  |
  +-------------+------+
  There is no primary key for this table, it may contain duplicates.
  Each row of this table contains the caller id, callee id and the duration of the call in minutes. caller_id != callee_id
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

A telecommunications company wants to invest in new countries. The
company intends to invest in the countries where the average call
duration of the calls in this country is strictly greater than the
global average call duration.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Write an SQL query to find the countries where this company can invest.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Return the result table in any order.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

The query result format is in the following example:

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  <code>Person</code> table:
  +----+----------+--------------+
  | id | name     | phone_number |
  +----+----------+--------------+
  | 3  | Jonathan | 051-1234567  |
  | 12 | Elvis    | 051-7654321  |
  | 1  | Moncef   | 212-1234567  |
  | 2  | Maroua   | 212-6523651  |
  | 7  | Meir     | 972-1234567  |
  | 9  | Rachel   | 972-0011100  |
  +----+----------+--------------+

  <code>Country</code> table:
  +----------+--------------+
  | name     | country_code |
  +----------+--------------+
  | Peru     | 051          |
  | Israel   | 972          |
  | Morocco  | 212          |
  | Germany  | 049          |
  | Ethiopia | 251          |
  +----------+--------------+

  Calls table:
  +-----------+-----------+----------+
  | caller_id | callee_id | duration |
  +-----------+-----------+----------+
  | 1         | 9         | 33       |
  | 2         | 9         | 4        |
  | 1         | 2         | 59       |
  | 3         | 12        | 102      |
  | 3         | 12        | 330      |
  | 12        | 3         | 5        |
  | 7         | 9         | 13       |
  | 7         | 1         | 3        |
  | 9         | 7         | 1        |
  | 1         | 7         | 7        |
  +-----------+-----------+----------+

  Result table:
  +----------+
  | country  |
  +----------+
  | Peru     |
  +----------+
  The average call duration for Peru is (102 + 102 + 330 + 330 + 5 + 5) / 6 = 145.666667
  The average call duration for Israel is (33 + 4 + 13 + 13 + 3 + 1 + 1 + 7) / 8 = 9.37500
  The average call duration for Morocco is (33 + 4 + 59 + 59 + 3 + 7) / 6 = 27.5000 
  Global call duration average = (2 * (33 + 4 + 59 + 102 + 330 + 5 + 13 + 3 + 1 + 7)) / 20 = 55.70000
  Since Peru is the only country where average call duration is greater than the global average, it&#39;s the only recommended country.
  </pre>
#+end_html

** Solutions
   :PROPERTIES:
   :CUSTOM_ID: solutions
   :END:

#+begin_html
  <!-- tabs:start -->
#+end_html

*** *SQL*
    :PROPERTIES:
    :CUSTOM_ID: sql
    :END:
#+begin_src sql
#+end_src

#+begin_html
  <!-- tabs:end -->
#+end_html

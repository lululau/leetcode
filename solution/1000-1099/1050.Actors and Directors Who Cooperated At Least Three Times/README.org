* [[https://leetcode-cn.com/problems/actors-and-directors-who-cooperated-at-least-three-times][1050.
合作过至少三次的演员和导演]]
  :PROPERTIES:
  :CUSTOM_ID: 合作过至少三次的演员和导演
  :END:
[[./solution/1000-1099/1050.Actors and Directors Who Cooperated At Least Three Times/README_EN.org][English
Version]]

** 题目描述
   :PROPERTIES:
   :CUSTOM_ID: 题目描述
   :END:

#+begin_html
  <!-- 这里写题目描述 -->
#+end_html

#+begin_html
  <p>
#+end_html

ActorDirector 表：

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +-------------+---------+
  | Column Name | Type    |
  +-------------+---------+
  | actor_id    | int     |
  | director_id | int     |
  | timestamp   | int     |
  +-------------+---------+
  timestamp 是这张表的主键.
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

写一条SQL查询语句获取合作过至少三次的演员和导演的 id 对 (actor_id,
director_id)

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

示例：

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  ActorDirector 表：
  +-------------+-------------+-------------+
  | actor_id    | director_id | timestamp   |
  +-------------+-------------+-------------+
  | 1           | 1           | 0           |
  | 1           | 1           | 1           |
  | 1           | 1           | 2           |
  | 1           | 2           | 3           |
  | 1           | 2           | 4           |
  | 2           | 1           | 5           |
  | 2           | 1           | 6           |
  +-------------+-------------+-------------+

  Result 表：
  +-------------+-------------+
  | actor_id    | director_id |
  +-------------+-------------+
  | 1           | 1           |
  +-------------+-------------+
  唯一的 id 对是 (1, 1)，他们恰好合作了 3 次。</pre>
#+end_html

** 解法
   :PROPERTIES:
   :CUSTOM_ID: 解法
   :END:

#+begin_html
  <!-- 这里可写通用的实现逻辑 -->
#+end_html

=GROUP BY= + =HAVING= 解决。

#+begin_html
  <!-- tabs:start -->
#+end_html

*** *SQL*
    :PROPERTIES:
    :CUSTOM_ID: sql
    :END:
#+begin_src sql
  # Write your MySQL query statement below
  SELECT
      actor_id, director_id
  FROM
      ActorDirector
  GROUP BY actor_id, director_id
  HAVING count(1) >= 3;
#+end_src

#+begin_html
  <!-- tabs:end -->
#+end_html

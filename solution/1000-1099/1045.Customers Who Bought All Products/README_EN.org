* [[https://leetcode.com/problems/customers-who-bought-all-products][1045.
Customers Who Bought All Products]]
  :PROPERTIES:
  :CUSTOM_ID: customers-who-bought-all-products
  :END:
[[./solution/1000-1099/1045.Customers Who Bought All Products/README.org][中文文档]]

** Description
   :PROPERTIES:
   :CUSTOM_ID: description
   :END:

#+begin_html
  <p>
#+end_html

Table: Customer

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +-------------+---------+
  | Column Name | Type    |
  +-------------+---------+
  | customer_id | int     |
  | product_key | int     |
  +-------------+---------+
  product_key is a foreign key to <code>Product</code> table.
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Table: Product

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +-------------+---------+
  | Column Name | Type    |
  +-------------+---------+
  | product_key | int     |
  +-------------+---------+
  product_key is the primary key column for this table.
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Write an SQL query for a report that provides the customer ids from the
Customer table that bought all the products in the Product table.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Return the result table in any order.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

The query result format is in the following example:

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  Customer table:
  +-------------+-------------+
  | customer_id | product_key |
  +-------------+-------------+
  | 1           | 5           |
  | 2           | 6           |
  | 3           | 5           |
  | 3           | 6           |
  | 1           | 6           |
  +-------------+-------------+

  Product table:
  +-------------+
  | product_key |
  +-------------+
  | 5           |
  | 6           |
  +-------------+

  Result table:
  +-------------+
  | customer_id |
  +-------------+
  | 1           |
  | 3           |
  +-------------+
  The customers who bought all the products (5 and 6) are customers with id 1 and 3.
  </pre>
#+end_html

** Solutions
   :PROPERTIES:
   :CUSTOM_ID: solutions
   :END:

#+begin_html
  <!-- tabs:start -->
#+end_html

*** *SQL*
    :PROPERTIES:
    :CUSTOM_ID: sql
    :END:
#+begin_src sql
  # Write your MySQL query statement below
  SELECT
      customer_id
  FROM
      Customer
  GROUP BY
      customer_id
  HAVING
      COUNT(DISTINCT(product_key)) = (
          SELECT
              COUNT(1)
          FROM
              Product
      );
#+end_src

#+begin_html
  <!-- tabs:end -->
#+end_html

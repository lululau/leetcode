* [[https://leetcode.com/problems/report-contiguous-dates][1225. Report
Contiguous Dates]]
  :PROPERTIES:
  :CUSTOM_ID: report-contiguous-dates
  :END:
[[./solution/1200-1299/1225.Report Contiguous Dates/README.org][中文文档]]

** Description
   :PROPERTIES:
   :CUSTOM_ID: description
   :END:

#+begin_html
  <p>
#+end_html

Table: Failed

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +--------------+---------+
  | Column Name  | Type    |
  +--------------+---------+
  | fail_date    | date    |
  +--------------+---------+
  Primary key for this table is fail_date.
  Failed table contains the days of failed tasks.
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

Table: Succeeded

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +--------------+---------+
  | Column Name  | Type    |
  +--------------+---------+
  | success_date | date    |
  +--------------+---------+
  Primary key for this table is success_date.
  Succeeded table contains the days of succeeded tasks.
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

A system is running one task every day. Every task is independent of the
previous tasks. The tasks can fail or succeed.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Write an SQL query to generate a report of period_state for each
continuous interval of days in the period from 2019-01-01 to 2019-12-31.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

period_state is 'failed' if tasks in this interval failed or
'succeeded' if tasks in this interval succeeded. Interval of days are
retrieved as start_date and end_date.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Order result by start_date.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

The query result format is in the following example:

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  Failed table:
  +-------------------+
  | fail_date         |
  +-------------------+
  | 2018-12-28        |
  | 2018-12-29        |
  | 2019-01-04        |
  | 2019-01-05        |
  +-------------------+

  Succeeded table:
  +-------------------+
  | success_date      |
  +-------------------+
  | 2018-12-30        |
  | 2018-12-31        |
  | 2019-01-01        |
  | 2019-01-02        |
  | 2019-01-03        |
  | 2019-01-06        |
  +-------------------+


  Result table:
  +--------------+--------------+--------------+
  | period_state | start_date   | end_date     |
  +--------------+--------------+--------------+
  | succeeded    | 2019-01-01   | 2019-01-03   |
  | failed       | 2019-01-04   | 2019-01-05   |
  | succeeded    | 2019-01-06   | 2019-01-06   |
  +--------------+--------------+--------------+

  The report ignored the system state in 2018 as we care about the system in the period 2019-01-01 to 2019-12-31.
  From 2019-01-01 to 2019-01-03 all tasks succeeded and the system state was &quot;succeeded&quot;.
  From 2019-01-04 to 2019-01-05 all tasks failed and system state was &quot;failed&quot;.
  From 2019-01-06 to 2019-01-06 all tasks succeeded and system state was &quot;succeeded&quot;.
  </pre>
#+end_html

** Solutions
   :PROPERTIES:
   :CUSTOM_ID: solutions
   :END:

#+begin_html
  <!-- tabs:start -->
#+end_html

*** *SQL*
    :PROPERTIES:
    :CUSTOM_ID: sql
    :END:
#+begin_src sql
#+end_src

#+begin_html
  <!-- tabs:end -->
#+end_html

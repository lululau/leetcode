* [[https://leetcode-cn.com/problems/queries-quality-and-percentage][1211.
查询结果的质量和占比]]
  :PROPERTIES:
  :CUSTOM_ID: 查询结果的质量和占比
  :END:
[[./solution/1200-1299/1211.Queries Quality and Percentage/README_EN.org][English
Version]]

** 题目描述
   :PROPERTIES:
   :CUSTOM_ID: 题目描述
   :END:

#+begin_html
  <!-- 这里写题目描述 -->
#+end_html

#+begin_html
  <p>
#+end_html

查询表 Queries： 

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +-------------+---------+
  | Column Name | Type    |
  +-------------+---------+
  | query_name  | varchar |
  | result      | varchar |
  | position    | int     |
  | rating      | int     |
  +-------------+---------+
  此表没有主键，并可能有重复的行。
  此表包含了一些从数据库中收集的查询信息。
  &ldquo;位置&rdquo;（<code>position</code>）列的值为 1 到 500 。
  &ldquo;评分&rdquo;（<code>rating</code>）列的值为 1 到 5 。评分小于 3 的查询被定义为质量很差的查询。
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

将查询结果的质量 quality 定义为：

#+begin_html
  </p>
#+end_html

#+begin_html
  <blockquote>
#+end_html

#+begin_html
  <p>
#+end_html

各查询结果的评分与其位置之间比率的平均值。

#+begin_html
  </p>
#+end_html

#+begin_html
  </blockquote>
#+end_html

#+begin_html
  <p>
#+end_html

将劣质查询百分比 poor_query_percentage 为：

#+begin_html
  </p>
#+end_html

#+begin_html
  <blockquote>
#+end_html

#+begin_html
  <p>
#+end_html

评分小于 3 的查询结果占全部查询结果的百分比。

#+begin_html
  </p>
#+end_html

#+begin_html
  </blockquote>
#+end_html

#+begin_html
  <p>
#+end_html

编写一组 SQL 来查找每次查询的名称(query_name)、质量(quality)
和 劣质查询百分比(poor_query_percentage)。

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

质量(quality) 和劣质查询百分比(poor_query_percentage)
都应四舍五入到小数点后两位。

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

查询结果格式如下所示：

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  Queries table:
  +------------+-------------------+----------+--------+
  | query_name | result            | position | rating |
  +------------+-------------------+----------+--------+
  | Dog        | Golden Retriever  | 1        | 5      |
  | Dog        | German Shepherd   | 2        | 5      |
  | Dog        | Mule              | 200      | 1      |
  | Cat        | Shirazi           | 5        | 2      |
  | Cat        | Siamese           | 3        | 3      |
  | Cat        | Sphynx            | 7        | 4      |
  +------------+-------------------+----------+--------+

  Result table:
  +------------+---------+-----------------------+
  | query_name | quality | poor_query_percentage |
  +------------+---------+-----------------------+
  | Dog        | 2.50    | 33.33                 |
  | Cat        | 0.66    | 33.33                 |
  +------------+---------+-----------------------+

  Dog 查询结果的质量为 ((5 / 1) + (5 / 2) + (1 / 200)) / 3 = 2.50
  Dog 查询结果的劣质查询百分比为 (1 / 3) * 100 = 33.33

  Cat 查询结果的质量为 ((2 / 5) + (3 / 3) + (4 / 7)) / 3 = 0.66
  Cat 查询结果的劣质查询百分比为 (1 / 3) * 100 = 33.33
  </pre>
#+end_html

** 解法
   :PROPERTIES:
   :CUSTOM_ID: 解法
   :END:

#+begin_html
  <!-- 这里可写通用的实现逻辑 -->
#+end_html

#+begin_html
  <!-- tabs:start -->
#+end_html

*** *SQL*
    :PROPERTIES:
    :CUSTOM_ID: sql
    :END:
#+begin_src sql
#+end_src

#+begin_html
  <!-- tabs:end -->
#+end_html

* [[https://leetcode.com/problems/league-statistics][1841. League
Statistics]]
  :PROPERTIES:
  :CUSTOM_ID: league-statistics
  :END:
[[./solution/1800-1899/1841.League Statistics/README.org][中文文档]]

** Description
   :PROPERTIES:
   :CUSTOM_ID: description
   :END:

#+begin_html
  <p>
#+end_html

Table: Teams

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>

  +----------------+---------+

  | Column Name    | Type    |

  +----------------+---------+

  | team_id        | int     |

  | team_name      | varchar |

  +----------------+---------+

  team_id is the primary key for this table.

  Each row contains information about one team in the league.

  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Table: Matches

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>

  +-----------------+---------+

  | Column Name     | Type    |

  +-----------------+---------+

  | home_team_id    | int     |

  | away_team_id    | int     |

  | home_team_goals | int     |

  | away_team_goals | int     |

  +-----------------+---------+

  (home_team_id, away_team_id) is the primary key for this table.

  Each row contains information about one match.

  home_team_goals is the number of goals scored by the home team.

  away_team_goals is the number of goals scored by the away team.

  The winner of the match is the team with the higher number of goals.

  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Write an SQL query to report the statistics of the league. The
statistics should be built using the played matches where the winning
team gets three points and the losing team gets no points. If a match
ends with a draw, both teams get one point.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Each row of the result table should contain:

#+begin_html
  </p>
#+end_html

#+begin_html
  <ul>
#+end_html

#+begin_html
  <li>
#+end_html

team_name - The name of the team in the Teams table.

#+begin_html
  </li>
#+end_html

#+begin_html
  <li>
#+end_html

matches_played - The number of matches played as either a home or away
team.

#+begin_html
  </li>
#+end_html

#+begin_html
  <li>
#+end_html

points - The total points the team has so far.

#+begin_html
  </li>
#+end_html

#+begin_html
  <li>
#+end_html

goal_for - The total number of goals scored by the team across all
matches.

#+begin_html
  </li>
#+end_html

#+begin_html
  <li>
#+end_html

goal_against - The total number of goals scored by opponent teams
against this team across all matches.

#+begin_html
  </li>
#+end_html

#+begin_html
  <li>
#+end_html

goal_diff - The result of goal_for - goal_against.

#+begin_html
  </li>
#+end_html

#+begin_html
  </ul>
#+end_html

#+begin_html
  <p>
#+end_html

Return the result table in descending order by points. If two or more
teams have the same points, order them in descending order by goal_diff.
If there is still a tie, order them by team_name in lexicographical
order.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

The query result format is in the following example:

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>

  Teams table:

  +---------+-----------+

  | team_id | team_name |

  +---------+-----------+

  | 1       | Ajax      |

  | 4       | Dortmund  |

  | 6       | Arsenal   |

  +---------+-----------+



  Matches table:

  +--------------+--------------+-----------------+-----------------+

  | home_team_id | away_team_id | home_team_goals | away_team_goals |

  +--------------+--------------+-----------------+-----------------+

  | 1            | 4            | 0               | 1               |

  | 1            | 6            | 3               | 3               |

  | 4            | 1            | 5               | 2               |

  | 6            | 1            | 0               | 0               |

  +--------------+--------------+-----------------+-----------------+





  Result table:

  +-----------+----------------+--------+----------+--------------+-----------+

  | team_name | matches_played | points | goal_for | goal_against | goal_diff |

  +-----------+----------------+--------+----------+--------------+-----------+

  | Dortmund  | 2              | 6      | 6        | 2            | 4         |

  | Arsenal   | 2              | 2      | 3        | 3            | 0         |

  | Ajax      | 4              | 2      | 5        | 9            | -4        |

  +-----------+----------------+--------+----------+--------------+-----------+



  Ajax (team_id=1) played 4 matches: 2 losses and 2 draws. Total points = 0 + 0 + 1 + 1 = 2.

  Dortmund (team_id=4) played 2 matches: 2 wins. Total points = 3 + 3 = 6.

  Arsenal (team_id=6) played 2 matches: 2 draws. Total points = 1 + 1 = 2.

  Dortmund is the first team in the table. Ajax and Arsenal have the same points, but since Arsenal has a higher goal_diff than Ajax, Arsenal comes before Ajax in the table.

  </pre>
#+end_html

** Solutions
   :PROPERTIES:
   :CUSTOM_ID: solutions
   :END:

#+begin_html
  <!-- tabs:start -->
#+end_html

*** *SQL*
    :PROPERTIES:
    :CUSTOM_ID: sql
    :END:
#+begin_src sql
#+end_src

#+begin_html
  <!-- tabs:end -->
#+end_html

* [[https://leetcode.com/problems/calculate-salaries][1468. Calculate
Salaries]]
  :PROPERTIES:
  :CUSTOM_ID: calculate-salaries
  :END:
[[./solution/1400-1499/1468.Calculate Salaries/README.org][中文文档]]

** Description
   :PROPERTIES:
   :CUSTOM_ID: description
   :END:

#+begin_html
  <p>
#+end_html

Table Salaries:

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +---------------+---------+
  | Column Name   | Type    |
  +---------------+---------+
  | company_id    | int     |
  | employee_id   | int     |
  | employee_name | varchar |
  | salary        | int     |
  +---------------+---------+
  (company_id, employee_id) is the primary key for this table.
  This table contains the company id, the id, the name and the salary for an employee.
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Write an SQL query to find the salaries of the employees after applying
taxes.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

The tax rate is calculated for each company based on the following
criteria:

#+begin_html
  </p>
#+end_html

#+begin_html
  <ul>
#+end_html

#+begin_html
  <li>
#+end_html

0% If the max salary of any employee in the company is less
than 1000\(.</li>  <li>24% If the max salary of any employee in the company is in the range [1000, 10000] inclusive.</li>  <li>49% If the max salary of any employee in the company is greater than 10000\).

#+begin_html
  </li>
#+end_html

#+begin_html
  </ul>
#+end_html

#+begin_html
  <p>
#+end_html

Return the result table in any order. Round the salary to the nearest
integer.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

The query result format is in the following example:

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  Salaries table:
  +------------+-------------+---------------+--------+
  | company_id | employee_id | employee_name | salary |
  +------------+-------------+---------------+--------+
  | 1          | 1           | Tony          | 2000   |
  | 1          | 2           | Pronub        | 21300  |
  | 1          | 3           | Tyrrox        | 10800  |
  | 2          | 1           | Pam           | 300    |
  | 2          | 7           | Bassem        | 450    |
  | 2          | 9           | Hermione      | 700    |
  | 3          | 7           | Bocaben       | 100    |
  | 3          | 2           | Ognjen        | 2200   |
  | 3          | 13          | Nyancat       | 3300   |
  | 3          | 15          | Morninngcat   | 7777   |
  +------------+-------------+---------------+--------+

  Result table:
  +------------+-------------+---------------+--------+
  | company_id | employee_id | employee_name | salary |
  +------------+-------------+---------------+--------+
  | 1          | 1           | Tony          | 1020   |
  | 1          | 2           | Pronub        | 10863  |
  | 1          | 3           | Tyrrox        | 5508   |
  | 2          | 1           | Pam           | 300    |
  | 2          | 7           | Bassem        | 450    |
  | 2          | 9           | Hermione      | 700    |
  | 3          | 7           | Bocaben       | 76     |
  | 3          | 2           | Ognjen        | 1672   |
  | 3          | 13          | Nyancat       | 2508   |
  | 3          | 15          | Morninngcat   | 5911   |
  +------------+-------------+---------------+--------+
  For company 1, Max salary is 21300. Employees in company 1 have taxes = 49%
  For company 2, Max salary is 700. Employees in company 2 have taxes = 0%
  For company 3, Max salary is 7777. Employees in company 3 have taxes = 24%
  The salary after taxes = salary - (taxes percentage / 100) * salary
  For example, Salary for Morninngcat (3, 15) after taxes = 7777 - 7777 * (24 / 100) = 7777 - 1866.48 = 5910.52, which is rounded to 5911.
  </pre>
#+end_html

** Solutions
   :PROPERTIES:
   :CUSTOM_ID: solutions
   :END:

#+begin_html
  <!-- tabs:start -->
#+end_html

*** *SQL*
    :PROPERTIES:
    :CUSTOM_ID: sql
    :END:
#+begin_src sql
#+end_src

#+begin_html
  <!-- tabs:end -->
#+end_html

* [[https://leetcode.com/problems/top-travellers][1407. Top Travellers]]
  :PROPERTIES:
  :CUSTOM_ID: top-travellers
  :END:
[[./solution/1400-1499/1407.Top Travellers/README.org][中文文档]]

** Description
   :PROPERTIES:
   :CUSTOM_ID: description
   :END:

#+begin_html
  <p>
#+end_html

Table: Users

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +---------------+---------+
  | Column Name   | Type    |
  +---------------+---------+
  | id            | int     |
  | name          | varchar |
  +---------------+---------+
  id is the primary key for this table.
  name is the name of the user.
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Table: Rides

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  +---------------+---------+
  | Column Name   | Type    |
  +---------------+---------+
  | id            | int     |
  | user_id       | int     |
  | distance      | int     |
  +---------------+---------+
  id is the primary key for this table.
  user_id is the id of the user who travelled the distance &quot;distance&quot;.
  </pre>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Write an SQL query to report the distance travelled by each user.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

Return the result table ordered by travelled_distance in descending
order, if two or more users travelled the same distance, order them by
their name in ascending order.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

The query result format is in the following example.

#+begin_html
  </p>
#+end_html

#+begin_html
  <p>
#+end_html

 

#+begin_html
  </p>
#+end_html

#+begin_html
  <pre>
  Users table:
  +------+-----------+
  | id   | name      |
  +------+-----------+
  | 1    | Alice     |
  | 2    | Bob       |
  | 3    | Alex      |
  | 4    | Donald    |
  | 7    | Lee       |
  | 13   | Jonathan  |
  | 19   | Elvis     |
  +------+-----------+

  Rides table:
  +------+----------+----------+
  | id   | user_id  | distance |
  +------+----------+----------+
  | 1    | 1        | 120      |
  | 2    | 2        | 317      |
  | 3    | 3        | 222      |
  | 4    | 7        | 100      |
  | 5    | 13       | 312      |
  | 6    | 19       | 50       |
  | 7    | 7        | 120      |
  | 8    | 19       | 400      |
  | 9    | 7        | 230      |
  +------+----------+----------+

  Result table:
  +----------+--------------------+
  | name     | travelled_distance |
  +----------+--------------------+
  | Elvis    | 450                |
  | Lee      | 450                |
  | Bob      | 317                |
  | Jonathan | 312                |
  | Alex     | 222                |
  | Alice    | 120                |
  | Donald   | 0                  |
  +----------+--------------------+
  Elvis and Lee travelled 450 miles, Elvis is the top traveller as his name is alphabetically smaller than Lee.
  Bob, Jonathan, Alex and Alice have only one ride and we just order them by the total distances of the ride.
  Donald didn&#39;t have any rides, the distance travelled by him is 0.
  </pre>
#+end_html

** Solutions
   :PROPERTIES:
   :CUSTOM_ID: solutions
   :END:

#+begin_html
  <!-- tabs:start -->
#+end_html

*** *SQL*
    :PROPERTIES:
    :CUSTOM_ID: sql
    :END:
#+begin_src sql
#+end_src

#+begin_html
  <!-- tabs:end -->
#+end_html
